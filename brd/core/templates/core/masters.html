{% extends 'base.html' %}

{% block content %}
<div class="container my-5">
    <h1 class="text-center mb-5 fw-bold" data-aos="fade-down">Наши мастера</h1>
    <div class="row justify-content-center">
        {% for master in masters %}
        <div class="col-md-6 col-lg-4 mb-5" data-aos="slide-up">
            <div class="flip-card" style="height: 450px;">
                <div class="flip-card-inner">
                    <div class="flip-card-front d-flex flex-column justify-content-center align-items-center bg-light">
                        {% if master.photo %}
                        <img src="{{ master.photo.url }}" class="rounded-circle mb-3"
                            style="width: 200px; height: 200px; object-fit: cover;" alt="{{ master.full_name }}">
                        {% else %}
                        <img src="https://via.placeholder.com/200?text=Мастер" class="rounded-circle mb-3">
                        {% endif %}
                        <h5 class="fw-bold">{{ master.full_name }}</h5>
                    </div>
                    <div
                        class="flip-card-back d-flex flex-column justify-content-center align-items-center text-white p-4">
                        <h5 class="fw-bold mb-3">{{ master.full_name }}</h5>
                        <p class="text-center flex-grow-1">{{ master.description }}</p>
                        <a href="#" class="btn btn-primary">Записаться к мастеру</a>
                    </div>
                </div>
            </div>
            <div class="mt-3">
    {% if master.reviews_count > 0 %}
        <p class="fw-bold">Рейтинг: {{ master.average_rating|floatformat:1 }} ⭐ ({{ master.reviews_count }} {{ master.reviews_count|pluralize:"отзыв,отзыва,отзывов" }})</p>
        <div class="small">
            {% for review in master.get_reviews|slice:":3" %}
            <div class="border-top pt-2 mb-2">
                <strong>{{ review.rating }} ⭐</strong>
                {% if review.comment %}
                <p class="mb-1"><em>"{{ review.comment }}"</em></p>
                {% endif %}
                <small class="text-muted">{{ review.created_at|date:"d.m.Y" }}</small>
            </div>
            {% endfor %}
        </div>
    {% else %}
        <p class="text-muted">Пока нет отзывов. Будьте первым!</p>
    {% endif %}
</div>
        </div>
        {% empty %}
        <p class="text-center">Мастеров пока нет.</p>
        {% endfor %}
    </div>
</div>

<style>
    .flip-card {
        perspective: 1000px;
        border-radius: 15px;
        box-shadow: 0 10px 20px rgba(0, 0, 0, 0.1);
    }

    .flip-card-inner {
        position: relative;
        width: 100%;
        height: 100%;
        text-align: center;
        transition: transform 0.8s;
        transform-style: preserve-3d;
    }

    .flip-card:hover .flip-card-inner {
        transform: rotateY(180deg);
    }

    .flip-card-front,
    .flip-card-back {
        position: absolute;
        width: 100%;
        height: 100%;
        backface-visibility: hidden;
        border-radius: 15px;
    }

    .flip-card-back {
        transform: rotateY(180deg);
        background: linear-gradient(45deg, #ffd700, #d4af37);
        color: #000;
    }
</style>
{% endblock %}